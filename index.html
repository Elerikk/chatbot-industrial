<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>ChatBot Ingenier√≠a Civil Industrial</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f2f2f2;
      padding: 20px;
    }
    #chatbox {
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 10px;
      padding: 15px;
      max-width: 500px;
      height: 400px;
      overflow-y: auto;
      white-space: pre-line;
    }
    .buttons-container {
      margin-top: 10px;
    }
    .option-btn {
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      background-color: #007bff;
      color: white;
    }
    #manualInput {
      margin-top: 10px;
    }
    #manualInput input {
      padding: 10px;
      font-size: 16px;
      width: 300px;
    }
    #manualInput button {
      padding: 10px;
      font-size: 16px;
      margin-left: 10px;
    }
    img.qr {
      margin-top: 10px;
      width: 150px;
    }
  </style>
</head>
<body>

<h2>Bienvenido al ChatBot de Ingenier√≠a Civil Industrial üë∑‚Äç‚ôÇÔ∏è</h2>
<div id="chatbox">¬øEn qu√© te puedo ayudar?
1. Informaci√≥n general de la carrera  
2. Preguntas Frecuentes (FAQ)  
3. Otros  
4. Salir
</div>

<div class="buttons-container" id="buttonsContainer"></div>

<div id="manualInput">
  <input type="text" id="userInput" placeholder="Escribe el n√∫mero de opci√≥n aqu√≠...">
  <button onclick="procesarEntrada(document.getElementById('userInput').value.trim()); document.getElementById('userInput').value = '';">Enviar</button>
</div>

<script>
let estado = 'menu';

const urlBuses = "https://uta.cl/buses";
const urlAdaptacion = "https://scanned.page/p/681e2c35aadee";

const menuPrincipal = "¬øEn qu√© te puedo ayudar?\n1. Informaci√≥n general de la carrera\n2. Preguntas Frecuentes (FAQ)\n3. Otros\n4. Salir";
const submenuInfoGeneral = "üìå Submen√∫ - Informaci√≥n General:\n1. Perfil de egreso\n2. Objetivos de la carrera\n3. √Åreas de formaci√≥n\n0. Volver";
const submenuFAQ = "‚ùì Submen√∫ - Preguntas Frecuentes:\n1. Licencias M√©dicas\n2. Trabajo al egresar\n3. Traslado\n4. Postulaciones\n5. Inscripciones\n6. Becas\n7. Biblioteca\n0. Volver";
const submenuOtros = "üîß Submen√∫ - Otros:\n1. Buses de acercamiento\n2. Denuncias y Acoso\n3. Servicio M√©dico Estudiantil\n4. Adaptaci√≥n Regular Acad√©mica\n0. Volver";

const botones = {
  'menu': ['1', '2', '3', '4'],
  'info_general': ['1', '2', '3', '0'],
  'faq': ['1', '2', '3', '4', '5', '6', '7', '0'],
  'otros': ['1', '2', '3', '4', '0']
};

function actualizarChat(texto) {
  const chatbox = document.getElementById('chatbox');
  chatbox.innerHTML += `\n${texto}`;
  chatbox.scrollTop = chatbox.scrollHeight;
}

function mostrarQR(url) {
  const chatbox = document.getElementById('chatbox');
  const qr = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(url)}`;
  chatbox.innerHTML += `\n<img class="qr" src="${qr}" alt="QR">`;
  chatbox.scrollTop = chatbox.scrollHeight;
}

function mostrarBotones(opciones) {
  const container = document.getElementById('buttonsContainer');
  container.innerHTML = '';
  opciones.forEach(op => {
    const btn = document.createElement('button');
    btn.className = 'option-btn';
    btn.innerText = op;
    btn.onclick = () => procesarEntrada(op);
    container.appendChild(btn);
  });
}

function procesarEntrada(entrada) {
  if (!entrada) return;

  switch (estado) {
    case 'menu':
      if (entrada === '1') { estado = 'info_general'; actualizarChat(submenuInfoGeneral); mostrarBotones(botones['info_general']); }
      else if (entrada === '2') { estado = 'faq'; actualizarChat(submenuFAQ); mostrarBotones(botones['faq']); }
      else if (entrada === '3') { estado = 'otros'; actualizarChat(submenuOtros); mostrarBotones(botones['otros']); }
      else if (entrada === '4') { estado = 'finalizado'; actualizarChat("üö™ Gracias por usar el chatbot. ¬°Hasta luego!"); mostrarBotones([]); }
      else actualizarChat("‚ùå Opci√≥n inv√°lida.");
      break;

    case 'info_general':
      if (entrada === '1') actualizarChat("üë®‚Äçüéì Perfil: lidera procesos organizacionales.\n\n" + submenuInfoGeneral);
      else if (entrada === '2') actualizarChat("üéØ Objetivo: formar profesionales √≠ntegros.\n\n" + submenuInfoGeneral);
      else if (entrada === '3') actualizarChat("üìö √Åreas: Ciencias B√°sicas, Ingenier√≠a, Gesti√≥n.\n\n" + submenuInfoGeneral);
      else if (entrada === '0') { estado = 'menu'; actualizarChat(menuPrincipal); mostrarBotones(botones['menu']); return; }
      else actualizarChat("‚ùå Opci√≥n inv√°lida.");
      mostrarBotones(botones['info_general']);
      break;

    case 'faq':
      if (entrada === '1') actualizarChat("üìÑ Licencias en Secretar√≠a de Carrera dentro de 3 d√≠as.\n\n" + submenuFAQ);
      else if (entrada === '2') actualizarChat("üè¢ Puedes trabajar en sector p√∫blico, privado, industria.\n\n" + submenuFAQ);
      else if (entrada === '3') actualizarChat("üîÑ Cambio de carrera/sede/instituci√≥n sujeto a requisitos.\n\n" + submenuFAQ);
      else if (entrada === '4') actualizarChat("üìù Postulaciones: ayudantes, tutores, CEC.\n\n" + submenuFAQ);
      else if (entrada === '5') actualizarChat("üìÜ Inscripciones v√≠a portal acad√©mico.\n\n" + submenuFAQ);
      else if (entrada === '6') actualizarChat("üéì Becas disponibles seg√∫n tipo y requisito.\n\n" + submenuFAQ);
      else if (entrada === '7') actualizarChat("üìö Biblioteca con m√∫ltiples recursos.\n\n" + submenuFAQ);
      else if (entrada === '0') { estado = 'menu'; actualizarChat(menuPrincipal); mostrarBotones(botones['menu']); return; }
      else actualizarChat("‚ùå Opci√≥n inv√°lida.");
      mostrarBotones(botones['faq']);
      break;

    case 'otros':
      if (entrada === '1') {
        actualizarChat("üöå Consulta los horarios y paradas de buses de acercamiento:");
        mostrarQR(urlBuses);
        actualizarChat("\n\n" + submenuOtros);
      }
      else if (entrada === '2') actualizarChat("üö® Las denuncias se pueden realizar en la Direcci√≥n de G√©nero.\n\n" + submenuOtros);
      else if (entrada === '3') actualizarChat("üè• Servicio m√©dico disponible con tu TUI. Horario: 8:00 a 17:00 hrs.\n\n" + submenuOtros);
      else if (entrada === '4') {
        actualizarChat("üìò Adaptaci√≥n acad√©mica se solicita con respaldo m√©dico o psicol√≥gico:");
        mostrarQR(urlAdaptacion);
        actualizarChat("\n\n" + submenuOtros);
      }
      else if (entrada === '0') { estado = 'menu'; actualizarChat(menuPrincipal); mostrarBotones(botones['menu']); return; }
      else actualizarChat("‚ùå Opci√≥n inv√°lida.");
      mostrarBotones(botones['otros']);
      break;
  }
}

window.onload = () => {
  mostrarBotones(botones['menu']);
  document.getElementById("userInput").addEventListener("keypress", function (e) {
    if (e.key === "Enter") {
      procesarEntrada(this.value.trim());
      this.value = '';
    }
  });
};
</script>

</body>
</html>
